故障注入：
故障注入的核心挑战是当盲目注入故障。例如在网络中shutdown 端口。此端口此时无流量通过，故障注入无效。基于此挑战我们提出精准时间，精准空间，精准幅度的故障注入能力。
核心思想是感知流量在时间片内经过此网络端口，对他进行精准幅度（丢包率，高时延， 拥塞程度，错包，闪断，降lane）的故障注入。同时兼容链路down，交换机down 常见故障。

丢包
逐流：某taskid的报文在经过第一跳node的时候，基于经过的统计报文字节/总字节数进行概率性丢包
逐包：某个taskid在首个报文经过的第一跳设备转发端口进行概率性丢包
时延
逐流：某taskid 的首包报文在经过第一跳node 的时候，增加转发时延
逐包：某个taskid 在首个报文经过的第一跳设备转发端口进行加时延
拥塞
逐流/逐包：先跑一遍流量，查看端口平均带宽信息。将最大带宽的端口在跑流量之前将带宽设置为最大带宽的一半
错包：
偶发丢包
逐流：某taskid 的报文在经过第一跳node的时候，偶发性丢包（0和1取一个概率，小于概率丢掉，大于概率正常转发）
逐包：某个taskid在首个报文经过的第一跳设备转发端口偶发性丢包（0和1取一个概率，小于概率丢掉，大于概率正常转发）
闪断：
逐流：某taskid 的报文在经过第一跳node的时候，偶发性丢包一段时恢复正常（从第几个包到第几个包丢掉）
逐包：某taskid 在首个报文经过的第一跳设备转发端口，偶发性丢包一段时间恢复正常（从第几个包到第几个包丢掉）
降lane
在开始跑仿真前将拓扑的带宽减为一半（可以提前跑一遍流量看下端口级带宽，选择有流量的端口进行降lane）

配置文件说明：
taskId,faultType,dropRate(%),delay(ns),lowerDataRate(node port datrate(Mbps)),shutdownDropPackets(start end),OccasionalDropRate(%)
0,0,10,0,0,0,0 概率丢包
0,1,0,1000,0,0,0 时延
0,2,0,0,8 2 100,0,0 拥塞 先跑一遍流量，查看端口平均 带宽信息。将最大带宽的端口在跑流量之前将带宽设置为最大带宽的一半,只能在流量出端口限速
0,3,0,0,0 0 0,2 10 ,0 闪断 设计一次连续丢包 shutdownDropPackets(start end) 参数表示开始丢包编号到结束丢包编号
0,4,0,0,8 2 100,0,0 降lane 在开始跑仿真前将拓扑的带宽减为一半（可以提前跑一遍流量看下端口级带宽，选择有流量的端口进行降lane）,只能在流量出端口限速
0,5,0,0,0 0 0,0,10 错包 设置偶发丢包率

链路down故障直接修改拓扑文件：
链路down，交换机down 修改路由文件删除对节点配置


网络参数相关设置(network_attribute.txt):
global UB_FAULT_ENABLE "true" 开启故障注入模块
default ns3::UbFault::UbFaultUsePacketSpray "true" 逐包模式故障判断（false为逐流模式）

逐流模式需要和UbTransportChannel中的配置同步
逐包-true   逐流-false
default ns3::UbTransportChannel::UsePacketSpray "false"

重传设置 
丢包场景下不开重传无法结束，需要开启重传结束仿真获取跟踪结果
default ns3::UbTransportChannel::TpOooThreshold "2048"
default ns3::UbTransportChannel::EnableRetrans "true" 
default ns3::UbTransportChannel::InitialRTO "25600ns"





